<template>
  <div class="front-content">
    <div class="login_form_container">
      <div class="deco_area">
        <div class="deco_text">
          <span class="sub_title">2022Web大作业</span><span class="main_title">教务系统</span>
        </div>
        <div class="deco_icon">
          <svg width="237" height="237" viewBox="0 0 37 37" fill="none" xmlns="http://www.w3.org/2000/svg">
            <path
                d="M18.0829 20.1431C16.1107 20.4555 14.0952 19.9716 12.4798 18.7979C10.8644 17.6242 9.78139 15.8569 9.46903 13.8847C9.15666 11.9126 9.64054 9.89706 10.8142 8.28164C11.9879 6.66622 13.7552 5.5832 15.7274 5.27084C17.6996 4.95848 19.7151 5.44236 21.3305 6.61603C22.9459 7.7897 24.0289 9.55702 24.3413 11.5292C24.6536 13.5014 24.1698 15.5169 22.9961 17.1323C21.8224 18.7477 20.0551 19.8307 18.0829 20.1431ZM17.7464 18.0185C18.4439 17.908 19.1129 17.6612 19.715 17.2922C20.3172 16.9232 20.8407 16.4393 21.2558 15.8679C21.6709 15.2966 21.9694 14.6491 22.1343 13.9624C22.2992 13.2757 22.3271 12.5632 22.2167 11.8657C22.1062 11.1682 21.8594 10.4993 21.4904 9.89711C21.1214 9.29497 20.6374 8.7714 20.0661 8.35629C19.4948 7.94119 18.8473 7.64269 18.1606 7.47783C17.4739 7.31297 16.7614 7.28497 16.0639 7.39545C14.6552 7.61857 13.3928 8.39215 12.5545 9.54602C11.7161 10.6999 11.3705 12.1395 11.5936 13.5482C11.8168 14.9569 12.5903 16.2193 13.7442 17.0576C14.8981 17.896 16.3377 18.2416 17.7464 18.0185ZM21.8528 28.5168L26.3712 29.5435L30.3512 27.1708L29.7041 23.0852L25.7241 25.4579L21.2057 24.4312L21.8528 28.5168ZM29.1487 20.9125C29.3902 20.7686 29.6632 20.686 29.9439 20.672C30.2246 20.658 30.5044 20.7129 30.759 20.832C31.0136 20.9511 31.2351 21.1308 31.4042 21.3553C31.5733 21.5797 31.6849 21.8422 31.7291 22.1198L32.5213 27.1211C32.5753 27.4606 32.5264 27.8085 32.3808 28.12C32.2353 28.4315 31.9998 28.6922 31.7047 28.8686L26.7336 31.8317L21.0923 30.5494C20.7568 30.4733 20.4519 30.2983 20.2168 30.0471C19.9817 29.7958 19.8274 29.4799 19.7736 29.1401L18.9815 24.1388C18.9376 23.8609 18.9626 23.5765 19.0541 23.3105C19.1456 23.0445 19.301 22.805 19.5066 22.613C19.7122 22.4209 19.9617 22.2822 20.2333 22.209C20.5049 22.1357 20.7904 22.1302 21.0646 22.1929L25.3614 23.1675L29.1487 20.9125Z"
                fill="#fff"/>
            <path
                d="M26.2673 19.9357C26.4935 20.1003 26.6467 20.3465 26.6944 20.6222C26.7421 20.8978 26.6805 21.1812 26.5227 21.4122C26.3649 21.6432 26.1233 21.8036 25.8492 21.8594C25.575 21.9152 25.29 21.8621 25.0544 21.7112C23.4932 20.6456 21.6541 20.0604 19.7642 20.0279C17.8742 19.9953 16.0161 20.5169 14.4191 21.5281C12.8221 22.5393 11.5561 23.9959 10.7774 25.7182C9.99859 27.4406 9.74112 29.3532 10.0367 31.2202C10.0814 31.5019 10.0122 31.7899 9.84456 32.0206C9.67689 32.2514 9.42442 32.4061 9.14268 32.4507C8.86094 32.4954 8.57301 32.4262 8.34223 32.2586C8.11146 32.0909 7.95674 31.8384 7.91212 31.5567C7.55062 29.2748 7.86515 26.937 8.81689 24.8318C9.76862 22.7266 11.3159 20.9461 13.2678 19.7101C15.2197 18.474 17.4908 17.8365 19.8008 17.8763C22.1108 17.916 24.3587 18.6312 26.2669 19.9336L26.2673 19.9357Z"
                fill="#fff"/>
          </svg>
        </div>
      </div>
      <div class="form_area">
        <div class="area_title">
          <svg t="1667572975881" class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg"
               p-id="2239" width="16" height="16">
            <path
                d="M512 0c-105.6 0-208 32-294.4 92.8C134.4 150.4 70.4 233.6 32 329.6l-9.6 25.6h112l3.2-12.8c19.2-44.8 48-83.2 83.2-118.4 76.8-76.8 179.2-118.4 288-118.4S720 147.2 796.8 224s118.4 179.2 118.4 288-41.6 211.2-118.4 288-179.2 118.4-288 118.4-211.2-41.6-288-118.4c-35.2-35.2-60.8-73.6-83.2-118.4l-3.2-12.8h-112l9.6 25.6c35.2 96 99.2 176 185.6 236.8S406.4 1024 512 1024c281.6 0 512-230.4 512-512S793.6 0 512 0zM0 563.2h467.2L358.4 672l73.6 73.6 236.8-236.8L432 272l-76.8 73.6 108.8 108.8H0v108.8z"
                fill="#000" p-id="2240"></path>
          </svg>
          <span>登录</span>
        </div>
        <div class="form_content">
          <a-form
              style="width: 220px"
              :model="loginTable"
              name="basic"
              :wrapper-col="{ span: 24 }"
              autocomplete="off"
              @finish="onFinish"
              @finishFailed="onFinishFailed"
          >
            <a-form-item
                name="stuId"
                :rules="[{ required: true, message: '请输入学生编号!' }]">
              <span>学生编号</span>
              <a-input v-model:value="loginTable.stuId">
                <template #prefix>
                  <UserOutlined style="color: rgba(0, 0, 0, 0.25)"/>
                </template>
              </a-input>
            </a-form-item>
            <a-form-item
                name="passwd"
                :rules="[{ required: true, message: '请输入正确的密码!' }]">
              <span>密码</span>
              <a-input-password v-model:value="loginTable.passwd">
                <template #prefix>
                  <LockOutlined style="color: rgba(0, 0, 0, 0.25)"/>
                </template>
              </a-input-password>
            </a-form-item>
            <a-form-item name="code">
              <div class="code-box">
                <a-input
                    placeholder="请输入验证码"
                    v-model:value="loginTable.code"
                >
                  <template #prefix>
                    <SafetyOutlined style="color: rgba(0, 0, 0, 0.25)"/>
                  </template>
                </a-input>
                <SIdentify :identifyCode="identifyCode" @click="refreshCode"/>
              </div>
            </a-form-item>

            <a-row :gutter="24">
              <a-col :span="12" class="remember-col">
                <a-form-item name="remember">
                  <a-checkbox v-model:checked="loginTable.remember">记住我</a-checkbox>
                </a-form-item>
              </a-col>
              <a-col :span="12" style="text-align: right">
                <a-form-item>
                  <a-button type="primary" html-type="submit">登录</a-button>
                </a-form-item>
              </a-col>
            </a-row>
          </a-form>
        </div>
      </div>
    </div>
  </div>
  <div class="deco_bg">
    <div class="deco_one">
      <svg width="240" height="240" viewBox="0 0 140 140" fill="none" xmlns="http://www.w3.org/2000/svg">
        <g clip-path="url(#clip0_8_394)">
          <path
              d="M61.7902 27.4439C63.2039 26.454 65.1525 26.7976 66.1425 28.2113L67.8789 30.6912L77.6383 23.8575C80.4658 21.8777 84.363 22.5649 86.3429 25.3924L120.455 74.1095C122.435 76.9371 121.748 80.8342 118.92 82.8141L65.1633 120.455C62.3358 122.435 58.4386 121.748 56.4587 118.92L22.3466 70.2031C20.3668 67.3755 21.0539 63.4783 23.8815 61.4985L34.1209 54.3288L32.3844 51.8489C31.3945 50.4352 31.7381 48.4866 33.1519 47.4967C34.5656 46.5067 36.5142 46.8503 37.5041 48.2641L39.2406 50.7439L62.7592 34.276L61.0228 31.7962C60.0328 30.3824 60.3764 28.4338 61.7902 27.4439ZM37.6275 81.1299L61.5784 115.335L115.335 77.6944L91.4736 43.6164L38.5167 80.6972C38.2374 80.8928 37.937 81.0363 37.6275 81.1299ZM66.2712 90.7097C66.9781 90.2147 67.9523 90.3865 68.4473 91.0934L71.1359 94.9332C71.6309 95.6401 71.4592 96.6144 70.7522 97.1094L66.9125 99.798C66.2055 100.293 65.2313 100.121 64.7363 99.4143L62.0477 95.5745C61.5527 94.8676 61.7245 93.8934 62.4314 93.3984L66.2712 90.7097ZM80.3503 80.8514C81.0573 80.3564 82.0315 80.5282 82.5265 81.2351L85.2151 85.0749C85.7101 85.7818 85.5383 86.756 84.8314 87.251L80.9916 89.9397C80.2847 90.4346 79.3105 90.2629 78.8155 89.5559L76.1269 85.7162C75.6319 85.0093 75.8037 84.035 76.5106 83.54L80.3503 80.8514ZM94.4295 70.993C95.1364 70.4981 96.1107 70.6698 96.6057 71.3768L99.2943 75.2165C99.7893 75.9235 99.6175 76.8977 98.9106 77.3927L95.0708 80.0813C94.3639 80.5763 93.3897 80.4045 92.8947 79.6976L90.206 75.8578C89.711 75.1509 89.8828 74.1767 90.5897 73.6817L94.4295 70.993ZM57.7571 78.5504C58.4641 78.0555 59.4383 78.2272 59.9333 78.9342L62.6219 82.7739C63.1169 83.4809 62.9451 84.4551 62.2382 84.9501L58.3984 87.6387C57.6915 88.1337 56.7173 87.9619 56.2223 87.255L53.5337 83.4152C53.0387 82.7083 53.2105 81.7341 53.9174 81.2391L57.7571 78.5504ZM71.8363 68.6921C72.5432 68.1971 73.5175 68.3689 74.0125 69.0758L76.7011 72.9156C77.1961 73.6225 77.0243 74.5967 76.3174 75.0917L72.4776 77.7804C71.7707 78.2754 70.7965 78.1036 70.3015 77.3967L67.6128 73.5569C67.1178 72.85 67.2896 71.8757 67.9965 71.3807L71.8363 68.6921ZM85.9155 58.8338C86.6224 58.3388 87.5966 58.5106 88.0916 59.2175L90.7803 63.0572C91.2753 63.7642 91.1035 64.7384 90.3966 65.2334L86.5568 67.922C85.8499 68.417 84.8756 68.2452 84.3807 67.5383L81.692 63.6985C81.197 62.9916 81.3688 62.0174 82.0757 61.5224L85.9155 58.8338ZM37.7057 59.4485L27.4663 66.6182L34.2211 76.2651C34.42 75.9996 34.6599 75.7675 34.9318 75.5775L87.8887 38.4967L81.2232 28.9772L71.4637 35.8109L73.2001 38.2907C74.1901 39.7045 73.8465 41.6531 72.4327 42.643C71.019 43.6329 69.0704 43.2893 68.0804 41.8756L66.344 39.3957L42.8254 55.8636L44.5618 58.3435C45.5517 59.7573 45.2082 61.7059 43.7944 62.6958C42.3806 63.6857 40.432 63.3421 39.4421 61.9284L37.7057 59.4485Z"
              fill="#3a3a3a"/>
        </g>
        <defs>
          <clipPath id="clip0_8_394">
            <rect width="100" height="100" fill="white" transform="translate(0 57.3577) rotate(-35)"/>
          </clipPath>
        </defs>
      </svg>
    </div>

    <div class="deco_two">
      <svg width="237" height="237" viewBox="0 0 37 37" fill="none" xmlns="http://www.w3.org/2000/svg">
        <path
            d="M29.756 18.7941C30.0202 19.2402 30.0354 19.7077 29.8017 20.0789C29.5645 20.4525 29.1347 20.6397 28.6187 20.5919L17.2906 19.5458L16.7343 25.5557C16.6947 25.9898 16.3108 26.3106 15.8737 26.2703C15.4395 26.2306 15.1188 25.8467 15.1591 25.4096L16.6143 9.63744C16.6966 8.76977 17.4667 8.13186 18.335 8.21119L29.6631 9.25726C30.1761 9.30441 30.5624 9.56913 30.7261 9.97841C30.8892 10.3907 30.7916 10.8496 30.4533 11.2327L27.3726 14.7623L29.756 18.7941ZM22.2808 24.011L20.3827 23.6076C19.9296 23.5113 19.6405 23.066 19.7368 22.613C19.8331 22.1599 20.2783 21.8708 20.7314 21.9671L24.6934 22.8092C24.9925 22.8728 25.224 23.1232 25.2819 23.4481L26.5284 30.5715C26.578 30.8482 26.4962 31.131 26.3067 31.3383C26.1279 31.5386 25.8549 31.6292 25.5936 31.5767L5.79217 27.3678C5.52693 27.3052 5.31262 27.1049 5.23501 26.8439C5.14745 26.5715 5.19495 26.2752 5.36224 26.0415L9.67973 20.1008C9.85375 19.8499 10.1593 19.723 10.4596 19.7806L12.1593 20.1419C12.5769 20.2307 12.8394 20.6702 12.7431 21.1233C12.6468 21.5764 12.2305 21.8748 11.81 21.7854L10.5841 21.5248L7.35093 25.9752L24.7805 29.68L23.8502 24.3446L22.3785 24.0318C22.3453 24.0278 22.3134 24.0179 22.2808 24.011Z"
            fill="#3a3a3a"/>
        <path
            d="M5.75815 27.5277C5.43368 27.4526 5.173 27.2084 5.07648 26.8907C4.97404 26.5718 5.03054 26.2186 5.22737 25.9479L9.54485 20.0071C9.75515 19.7021 10.1245 19.5516 10.49 19.6231L12.1927 19.985C12.699 20.0926 13.0169 20.6213 12.9023 21.1603C12.7871 21.7022 12.2817 22.0559 11.7754 21.9483L10.656 21.7103L7.63299 25.8712L24.5799 29.4733L23.7096 24.4819L20.3486 23.7675C19.8067 23.6523 19.4623 23.1179 19.5768 22.579C19.692 22.0371 20.2264 21.6926 20.7653 21.8072L24.7274 22.6493C25.0916 22.7267 25.3735 23.0312 25.4425 23.4203L26.6891 30.5438C26.7469 30.8686 26.6472 31.2065 26.4252 31.4502C26.2104 31.6893 25.8771 31.801 25.5596 31.7367L5.75815 27.5277ZM10.425 19.9435C10.1898 19.8997 9.94932 19.9972 9.81095 20.1968L9.80736 20.1991L5.48987 26.1399C5.35401 26.3276 5.31424 26.573 5.3846 26.7953C5.44562 27.0032 5.61355 27.1596 5.82317 27.2073L25.6217 31.4156C25.8266 31.4561 26.0401 31.3838 26.1815 31.2282C26.3379 31.0602 26.4066 30.8242 26.3648 30.5986L25.1182 23.4752C25.0709 23.2175 24.8904 23.0182 24.6564 22.9685L20.6973 22.127C20.3331 22.0496 19.974 22.2827 19.8966 22.647C19.8192 23.0112 20.0524 23.3702 20.4166 23.4477L22.1548 23.8171L22.1567 23.8082L22.3236 23.853C22.3532 23.8593 22.3822 23.8686 22.4089 23.8742L23.9961 24.2116L24.988 29.8975L7.07283 26.0895L10.5167 21.3465L11.8433 21.6284C12.172 21.6983 12.5015 21.4588 12.5795 21.0917C12.6569 20.7274 12.4534 20.3747 12.1247 20.3048L10.425 19.9435ZM15.7496 26.4172C15.2847 26.3184 14.9532 25.8827 14.9977 25.397L16.4559 9.62546C16.5446 8.66939 17.3974 7.96241 18.3535 8.05111L29.6816 9.09719C30.2551 9.151 30.6927 9.45137 30.8806 9.92151C31.0678 10.3946 30.9577 10.9128 30.5778 11.3458L27.5754 14.7837L30.0619 18.986L30.0287 18.982C30.1881 19.3966 30.1582 19.8142 29.9384 20.1637C29.6678 20.5921 29.1796 20.8071 28.6025 20.7556L17.4351 19.7251L16.895 25.5713C16.8718 25.8263 16.752 26.0546 16.5535 26.2167C16.358 26.3794 16.1095 26.4566 15.8545 26.4333C15.8242 26.43 15.7851 26.4248 15.7496 26.4172ZM29.8205 9.44858C29.7642 9.43662 29.7103 9.42825 29.6498 9.42159L18.3217 8.37552C17.5448 8.30322 16.8532 8.87736 16.778 9.65368L15.3257 25.4265C15.2931 25.7693 15.5464 26.0769 15.8928 26.1072C16.0595 26.1241 16.2222 26.072 16.3499 25.9661C16.4777 25.8601 16.5597 25.7073 16.5729 25.543L17.1425 19.3689L28.6349 20.4283C29.0875 20.4687 29.4617 20.31 29.6656 19.9912C29.8659 19.6748 29.8471 19.2684 29.6172 18.8791L29.4531 18.6028L29.4561 18.6034L27.1744 14.748L30.3328 11.1297C30.6272 10.7931 30.7175 10.3975 30.5763 10.0425C30.4553 9.73826 30.1847 9.526 29.8205 9.44858Z"
            fill="#3a3a3a"/>
      </svg>
    </div>

    <div class="deco_three">

      <svg width="237" height="237" viewBox="0 0 37 37" fill="none" xmlns="http://www.w3.org/2000/svg">
        <g clip-path="url(#clip0_9_791)">
          <path
              d="M12.6614 12.5599L26.0179 14.915C26.5445 15.0078 27.0472 14.6558 27.1401 14.1292C27.233 13.6026 26.881 13.0998 26.3543 13.0069L12.9979 10.6518C12.4712 10.5589 11.9685 10.911 11.8756 11.4376C11.7828 11.9643 12.1348 12.467 12.6614 12.5599ZM25.3476 18.7159L11.9912 16.3608C11.4646 16.2679 10.9618 16.6199 10.869 17.1466C10.7761 17.6733 11.1281 18.176 11.6548 18.2689L25.0112 20.624C25.5379 20.7168 26.0406 20.3648 26.1335 19.8381C26.2263 19.3115 25.8743 18.8088 25.3476 18.7159ZM24.3383 24.4401L10.9819 22.085C10.4552 21.9921 9.95251 22.3441 9.85965 22.8708C9.76678 23.3974 10.1188 23.9002 10.6455 23.993L24.0019 26.3481C24.5285 26.441 25.0313 26.089 25.1241 25.5623C25.217 25.0357 24.865 24.5329 24.3383 24.4401ZM17.5683 7.51511L22.3386 8.35623C23.1294 8.49567 23.8827 7.96742 24.0219 7.17752C24.1612 6.38761 23.6331 5.63342 22.8432 5.49413L18.073 4.65302C17.2831 4.51373 16.5289 5.04182 16.3896 5.83173C16.2503 6.62164 16.7784 7.37583 17.5683 7.51511ZM30.2271 7.7798L29.273 7.61158C28.7464 7.51871 28.2436 7.87073 28.1508 8.39739C28.0579 8.92404 28.4099 9.42678 28.9366 9.51964L29.8906 9.68786C30.9429 9.87341 31.6478 10.8801 31.4622 11.9324L28.266 30.0589C28.0805 31.1112 27.0738 31.8161 26.0215 31.6306L6.94091 28.2661C5.88864 28.0806 5.18375 27.0739 5.36929 26.0216L8.5655 7.89503C8.75104 6.84276 9.75774 6.13786 10.81 6.32341L11.764 6.49163C12.2907 6.58449 12.7934 6.23247 12.8863 5.70582C12.9792 5.17916 12.6271 4.67643 12.1005 4.58356L11.1464 4.41534C9.03902 4.04375 7.02903 5.45113 6.65743 7.55858L3.46123 25.6851C3.08962 27.7927 4.49702 29.8026 6.60447 30.1742L25.6851 33.5386C27.7926 33.9102 29.8025 32.5029 30.1741 30.3953L33.3703 12.2688C33.7419 10.1614 32.3346 8.15141 30.2271 7.7798Z"
              fill="#3A3A3A"/>
        </g>
        <defs>
          <clipPath id="clip0_9_791">
            <rect width="31" height="31" fill="white" transform="translate(5.927 0.543945) rotate(10)"/>
          </clipPath>
        </defs>
      </svg>

    </div>

    <div class="deco_four">
      <svg width="198" height="199" viewBox="0 0 98 99" fill="none" xmlns="http://www.w3.org/2000/svg">
        <path
            d="M30.8322 45.398L40.6344 48.0245C41.9342 48.3725 43.3187 48.1914 44.4833 47.5208C45.6479 46.8503 46.4973 45.7453 46.8447 44.4489C47.1921 43.1525 47.009 41.7708 46.3356 40.6078C45.6623 39.4448 44.5539 38.5957 43.2542 38.2472L33.452 35.6207C32.8084 35.4481 32.1371 35.4037 31.4766 35.49C30.816 35.5763 30.1792 35.7916 29.6023 36.1235C29.0255 36.4555 28.52 36.8977 28.1147 37.4249C27.7094 37.952 27.4123 38.5538 27.2402 39.1959C27.0682 39.8379 27.0246 40.5077 27.1121 41.1668C27.1995 41.826 27.4161 42.4617 27.7497 43.0376C28.0832 43.6136 28.5271 44.1184 29.056 44.5234C29.5849 44.9284 30.1885 45.2256 30.8322 45.398ZM82.8017 27.8854L58.2961 21.3192L60.9159 11.5419L65.817 12.8552C67.1169 13.2035 68.5015 13.0224 69.6663 12.3519C70.8311 11.6814 71.6806 10.5763 72.028 9.27979C72.3755 7.98324 72.1923 6.60144 71.5188 5.43836C70.8453 4.27528 69.7367 3.4262 68.4368 3.07791L58.6346 0.451407C57.3347 0.103111 55.9501 0.284132 54.7853 0.954646C53.6205 1.62516 52.771 2.73024 52.4236 4.02679L48.4939 18.6927L33.7905 14.7529C28.5911 13.3597 23.0526 14.0838 18.3934 16.7659C13.7342 19.4479 10.3361 23.8683 8.94642 29.0544L1.08699 58.3862C0.739585 59.6828 0.922772 61.0646 1.59626 62.2277C2.26974 63.3907 3.37835 64.2398 4.67821 64.5881L34.0849 72.4676L28.8453 92.0221C28.4979 93.3187 28.6811 94.7005 29.3546 95.8636C30.028 97.0266 31.1366 97.8757 32.4365 98.224C33.7364 98.5723 35.121 98.3913 36.2858 97.7208C37.4506 97.0503 38.3001 95.9452 38.6475 94.6486L43.8872 75.0941L83.0961 85.6001C84.3959 85.9484 85.7806 85.7674 86.9454 85.0969C88.1102 84.4264 88.9597 83.3213 89.3071 82.0247L97.1665 52.693C98.5562 47.5068 97.8234 41.9796 95.1295 37.3273C92.4356 32.6749 88.0011 29.2786 82.8017 27.8854ZM57.9576 42.187L51.4081 66.6301L12.1991 56.1241L18.7487 31.6809C19.0927 30.397 19.6869 29.1935 20.4974 28.1393C21.3078 27.085 22.3187 26.2007 23.4722 25.5367C24.6256 24.8727 25.8992 24.442 27.2201 24.2693C28.541 24.0966 29.8835 24.1853 31.1707 24.5302L63.322 33.1451C60.7491 35.6204 58.8955 38.7445 57.9576 42.187ZM80.8148 74.5096L61.2103 69.2566L67.7598 44.8135C68.4547 42.2204 70.1537 40.0102 72.4833 38.6692C74.8129 37.3281 77.5822 36.9661 80.1819 37.6627C82.7816 38.3593 84.9988 40.0574 86.3458 42.3836C87.6927 44.7098 88.0591 47.4734 87.3643 50.0665L80.8148 74.5096Z"
            fill="#3a3a3a"/>
      </svg>

    </div>
  </div>
</template>

<script>
import {message} from "ant-design-vue";
import {UserOutlined, LockOutlined, SafetyOutlined} from '@ant-design/icons-vue';
import axios from "axios";
import SIdentify from "@/components/identify";
import cookie from "@/assets/js/cookie";

export default {
  name: "login_page",
  components: {
    SIdentify,
    UserOutlined,
    LockOutlined,
    SafetyOutlined
  },
  mounted() {
    window.vue = this
    this.identifyCode = ''
    this.makeCode(this.identifyCodes, 4)
  },
  data() {
    return {
      identifyCodes: '1234567890',
      identifyCode: '',
      loginTable: {
        stuId: '',
        passwd: '',
        code: '',
        remember: true,
      },
    }
  },
  methods: {
    renewCookie(uinfo, remember) {
      let exp = new Date()
      remember ? exp.setDate(exp.getDate() + 7) : exp.setMinutes(exp.getMinutes() + 10)
      document.cookie = `uid=${uinfo.id}; expires=${exp.toUTCString()}; `;
      document.cookie = `login=suc; expires=${exp.toUTCString()}; `;
    },
    onFinish: function (values) {
      let query_field = {
        stuId: values.stuId,
        passwd: values.passwd,
      }
      let code = values.code
      console.log(this.validateCode(code))
      if (!this.validateCode(code)) {
        this.loginTable.code = ""
      }
      var that = this
      if (values) return
      axios.post('http://127.0.0.1:3000/api/user/login', query_field).then(
          (res) => {
            if (res.data.length > 0) {
              console.log(res.data[0])
              console.log(that)
              that.renewCookie(res.data[0], values.remember)
              that.$router.push('/mp')
            } else {
              message.error("登录失败")
            }
          },
      ).catch(err => {
        console.log(err)
        message.error("登录失败")
      });
    },
    onFinishFailed: (e) => {
      console.log(e)
      message.warn("请正确填写信息")
    },
    randomNum(min, max) {
      return Math.floor(Math.random() * (max - min) + min)
    },
    refreshCode() {
      this.identifyCode = ''
      this.makeCode(this.identifyCodes, 4)
    },
    makeCode(o, l) {
      for (let i = 0; i < l; i++) {
        this.identifyCode += this.identifyCodes[this.randomNum(0, this.identifyCodes.length)]
      }
    },
    validateCode(value) {
      if (value === '') {
        message.error('验证码为空')
        return false
      } else if (value !== this.identifyCode) {
        message.error('验证码不正确')
        return false
      } else {
        return true
      }
    }
  }
}
</script>

<style scoped>
.login_form_container {
  width: 800px;
  height: 450px;
  background-color: #fff;
  border-radius: 6px;

  position: absolute;
  top: calc(50% - 225px);
  left: calc(50% - 400px);

  box-shadow: 0px 0px 12px #00000044;


  display: flex;
}

.deco_area {
  position: relative;
  width: 400px;
  height: 100%;
  padding: 45px;
  border-radius: 6px 0 0 6px;
  background-color: #108ee9;
}

.form_area {
  position: relative;
  width: 400px;
  padding: 45px;
  border-radius: 0 6px 6px 0;
}

.area_title {
  position: absolute;
  font-size: 24px;
  line-height: 24px;
  width: 100px;
  text-align: center;
  left: calc(50% - 50px);

  display: flex;
  align-items: flex-end;
  justify-content: center;
}

.area_title > svg {
  margin-right: 3px;
}

.form_content {
  margin: 0 auto;
  width: 220px;
  height: 100%;
  display: flex;
  align-items: center;
  justify-content: center;
}

.remember-col {
  text-align: left;
  font-family: "Alibaba PuHuiTi 2.0", serif
}

.front-content {
  width: 100%;
  height: 100%;
  position: absolute;
  --theme-color: #1890ff;
  z-index: 99;
}

.deco_bg {
  position: absolute;
  width: 100%;
  height: 100%;
}

@keyframes floating {
  from {
    transform: translate(0, 0);
  }
  25% {
    transform: translate(22px, 25px) rotate3d(-5, -3, -4, 13deg);
  }
  50% {
    transform: translate(18px, 50px) rotate3d(-3, -4, -5, 15deg);
  }
  to {
    transform: translate(0, 0);
  }
}

@keyframes floating_2 {
  from {
    transform: translate(0, 0) rotate3d(0, 0, 0);
  }
  50% {
    transform: translate(-18px, -50px) rotate3d(3, 4, 5, 13deg);
  }
  75% {
    transform: translate(-10px, -55px) rotate3d(5, 3, 4, 15deg);
  }
  to {
    transform: translate(0, 0) rotate3d(0, 0, 0);
  }
}

.deco_one {
  position: absolute;
  right: 158px;
  bottom: 38px;
  z-index: 100;
  animation-delay: 1s;
  animation: floating 23s ease-in-out infinite;
}

.deco_two {
  position: absolute;
  left: 28px;
  top: 38px;
  animation: floating 23s ease-in-out infinite;
}

.deco_icon {
  position: absolute;
  bottom: 0;
  left: 0;
}

.deco_three {
  position: absolute;
  bottom: 38px;
  left: 180px;
  z-index: -1;
  animation-delay: 1s;
  animation: floating_2 23s ease-in-out infinite;
}

.deco_four {
  top: 28px;
  right: 58px;
  position: absolute;
  animation: floating_2 23s ease-in-out infinite;
}

.deco_text {
  color: #fff;
  font-size: 24px;
  display: flex;
  flex-direction: column;
}

.sub_title {
  font-size: 14px;
}

.main_title {
}

.code-box {
  display: flex;
  margin-bottom: 12px;
  background-color: #d9d9d9;
}

.code-box > img {
  flex-grow: 1;
  flex-basis: 70%;
}
</style>